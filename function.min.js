/**
 * Web Analytics Implementation Playground
 *
 * Main function file with the source code of the different events and parameters
 * that are being sent to Google Analytics and Tealium.
 *
 * @author:	Arturo Santiago-Rivera (asantiago@arsari.com)
 * @license: MIT License
 */
function displayJSON(status){let userLogged="";status?userLogged="<span>User Logged In</span>":"logout"===window.dataLayer.at(-1).event&&(userLogged='<span class="alert">User Logged Out</span>'),document.querySelector("#json").innerHTML+=`<p><em>dataLayer.push and utag.link [${window.dataLayer.length}]</em>${userLogged}</p><pre>${JSON.stringify(window.dataLayer.at(-1),void 0,2)}</pre>`,document.querySelectorAll("pre").forEach(e=>{e.className="normal",e.previousElementSibling.className="normal"});const focusThis=document.querySelector("#json");focusThis.lastElementChild.scrollIntoView(),focusThis.lastElementChild.className="highlight",focusThis.lastElementChild.previousElementSibling.classList.remove("normal")}function searchModal(){sModal.classList.toggle("show-modal")}function formModal(){fModal.classList.toggle("show-modal")}function capitalize(str){return str.charAt(0).toUpperCase()+str.slice(1).toLowerCase()}function timeStamp(){const d=new Date,tzo=d.getTimezoneOffset(),dif=tzo>=0?"-":"+",pad=num=>{const norm=Math.floor(Math.abs(num));return(norm<10?"0":"")+norm},stamp=`${d.getFullYear()}-${pad(d.getMonth()+1)}-${pad(d.getDate())} T${pad(d.getHours())}:${pad(d.getMinutes())}:${pad(d.getSeconds())}.${pad(d.getMilliseconds())} UTC${dif}${pad(tzo/60)}:${pad(tzo%60)}`;return stamp}function errorEvent(e,m,l,u){alert(m);const tstamp=(new Date).getTime(),cstamp=timeStamp();window.dataLayer=window.dataLayer||[],window.dataLayer.push({event:`${e.id}_error`,event_timestamp:tstamp,custom_timestamp:cstamp,event_type:"content tool",button_text:e.innerText,tag_name:e.tagName,error_message:m,alert_impression:!0,logged_in:l,user_id:u}),utag.link({tealium_event:`${e.id}_error`,event_timestamp:tstamp,custom_timestamp:cstamp,event_type:"content tool",button_text:e.innerText,tag_name:e.tagName,error_message:m,alert_impression:!0,logged_in:l,user_id:u}),displayJSON(l)}const headerHeight=document.querySelector("header").offsetHeight;document.querySelector("main").style=`margin-top: ${headerHeight+15}px`,document.querySelector("footer").innerHTML=`<span class="env">Env->[\n  <span class="prop">${tealiumEnv}</span> ] &boxV; GA4->[ <span class="prop">${ga4Prop}</span> ] &boxV; GTM->[ <span class="prop">${gtmContainer}</span> ]\n  </span><span class="me">Coded with &hearts; by ARSARI &boxV; Best view in Desktop</span>`;let logged=!1,vplay=!1,vstop=!0,vprogress=0;const vduration=300,sModal=document.querySelector(".searchModal"),fModal=document.querySelector(".formModal"),UUID=`U-${self.crypto.getRandomValues(new Uint32Array(1))}`,elemClick=document.querySelectorAll('[name="action"]');elemClick.forEach(e=>{e.addEventListener("click",()=>{let ui=logged?UUID:"guest",en,cm,cc,val,vt,vp,vct,vd,milestone,vs,vpct,lu,lc,ol,ld,st,fd,up,message;if("purchase"===e.id){if(!logged)return message="ERROR: Please Sign In!",void errorEvent(e,message,logged,ui);{const transactionID=`T-${Math.floor(1e4*Math.random())}`,sku1=`SKU_${Math.floor(1e4*Math.random())}`,sku2=`SKU_${Math.floor(1e4*Math.random()+1)}`,itemPrice=Math.floor(200*Math.random()+1),itemQty=Math.floor(30*Math.random()+1),itemDiscount=Number((.15*itemPrice).toFixed(2)),subtotal=Number(((itemPrice-itemDiscount)*itemQty*2).toFixed(2)),tstamp=(new Date).getTime(),cstamp=timeStamp();window.dataLayer=window.dataLayer||[],window.dataLayer.push({ecommerce:null}),utag.link({ecommerce:null}),displayJSON(logged),window.dataLayer=window.dataLayer||[],window.dataLayer.push({event:e.id,event_timestamp:tstamp,custom_timestamp:cstamp,event_type:"conversion",button_text:e.innerText,tag_name:e.tagName,ecommerce:{transaction_id:transactionID,affiliation:"Merchandise Store",coupon:"SUMMER_SALE",currency:"USD",shipping:Number((.12*subtotal).toFixed(2)),tax:Number((.07*subtotal).toFixed(2)),value:subtotal,items:[{item_id:sku1,item_name:"Stan and Friends Tee",affiliation:"Merchandise Store",coupon:"SUMMER_FUN",currency:"USD",discount:itemDiscount,index:0,item_brand:"MyCollection",item_category:"Apparel",item_category2:"Adult",item_category3:"Shirts",item_category4:"Crew",item_category5:"Short sleeve",item_list_id:"related_products",item_list_name:"Related Products",item_variant:"green",location_id:"ChIJIQBpAG2ahYAR_6128GcTUEo",price:itemPrice,quantity:itemQty},{item_id:sku2,item_name:"Friends Pants",affiliation:"Merchandise Store",coupon:"SUMMER_FUN",currency:"USD",discount:itemDiscount,index:1,item_brand:"MyCollection",item_category:"Apparel",item_category2:"Adult",item_category3:"Pants",item_category4:"Crew",item_category5:"Regular Fit",item_list_id:"related_products",item_list_name:"Related Products",item_variant:"blue",location_id:"ChIJIQBpAG2ahYAR_6128GcTUEo",price:itemPrice,quantity:itemQty}]},logged_in:logged,user_id:ui}),utag.link({tealium_event:e.id,event_timestamp:tstamp,custom_timestamp:cstamp,event_type:"conversion",button_text:e.innerText,tag_name:e.tagName,ecommerce:{transaction_id:transactionID,affiliation:"Merchandise Store",coupon:"SUMMER_SALE",currency:"USD",shipping:Number((.12*subtotal).toFixed(2)),tax:Number((.07*subtotal).toFixed(2)),value:subtotal,items:[{item_id:sku1,item_name:"Stan and Friends Tee",affiliation:"Merchandise Store",coupon:"SUMMER_FUN",currency:"USD",discount:itemDiscount,index:0,item_brand:"MyCollection",item_category:"Apparel",item_category2:"Adult",item_category3:"Shirts",item_category4:"Crew",item_category5:"Short sleeve",item_list_id:"related_products",item_list_name:"Related Products",item_variant:"green",location_id:"ChIJIQBpAG2ahYAR_6128GcTUEo",price:itemPrice,quantity:itemQty},{item_id:sku2,item_name:"Friends Pants",affiliation:"Merchandise Store",coupon:"SUMMER_FUN",currency:"USD",discount:itemDiscount,index:1,item_brand:"MyCollection",item_category:"Apparel",item_category2:"Adult",item_category3:"Pants",item_category4:"Crew",item_category5:"Regular Fit",item_list_id:"related_products",item_list_name:"Related Products",item_variant:"blue",location_id:"ChIJIQBpAG2ahYAR_6128GcTUEo",price:itemPrice,quantity:itemQty}]},logged_in:logged,user_id:ui}),displayJSON(logged)}}else{if("email"!==e.id&&"phone"!==e.id||(en="generate_lead",cc="USD","email"===e.id?(cm="email",val=50):(cm="phone",val=25)),"form-modal"===e.id&&(en="form_start",fd="form modal open",formModal()),"form"===e.id){if(!e.previousElementSibling.value.trim())return message="ERROR: Form input can't be blank.",void errorEvent(e,message,logged,ui);{const verify=e.previousElementSibling.value.trim();if(verify.match(/mailto:|tel:|^[\w\-.]+@[\w\-.]+/gi))return message="ERROR: PII not allowed in form input.",errorEvent(e,message,logged,ui),void(e.previousElementSibling.value="");up=capitalize(verify),e.previousElementSibling.value=""}en="form_submit",cm="form filled",fd="customer service",cc="USD",val=100,formModal()}if("form-close"===e.id&&(en="form_modal_closed",formModal()),"download"===e.id){if(!logged)return message="ERROR: Please Sign In!",void errorEvent(e,message,logged,ui);en="file_download",ld=window.location.hostname,lc=e.className}if("extlink"===e.id||"banner"===e.id){en="outbound_link",lu=e.href;const domain=new URL(lu);ld=domain.hostname,lc=e.className?e.className:void 0,ol=!0}if("intlink"===e.id){localStorage.logged=logged,localStorage.UUID=ui,en="internal_link",lu=e.href;const domain=new URL(lu);ld=domain.hostname,lc=e.className}"video"===e.id&&(vt="Walk in The Clouds",vp="Any Video Player",vstop?(document.querySelector("#video .text").classList.add("playing"),en="video_start",vplay=!0,vs="Play",vct=vprogress,vd=300,vpct=Number((vprogress/300*100).toFixed(1)),vstop=!1):(document.querySelector("#video .text").classList.remove("playing"),en="video_stop",vplay=!1,vs="Stop",vct=vprogress,vd=300,vpct=Number((vprogress/300*100).toFixed(1)),vstop=!0));const interval=setInterval(()=>{if(vp="Any Video Player",vt="Walk in The Clouds",ui=logged?UUID:"guest",vplay){vprogress+=1;const sendData=()=>{window.dataLayer=window.dataLayer||[],window.dataLayer.push({event:en,event_timestamp:tstamp,custom_timestamp:cstamp,button_text:null,tag_name:null,event_type:"content tool",video_current_time:vct,video_duration:300,video_percent:milestone,video_provider:vp,video_status:vs,video_title:vt,logged_in:logged,user_id:ui}),utag.link({tealium_event:en,event_timestamp:tstamp,custom_timestamp:cstamp,event_type:"content tool",button_text:null,tag_name:null,video_current_time:vct,video_duration:300,video_percent:milestone,video_provider:vp,video_status:vs,video_title:vt,logged_in:logged,user_id:ui}),displayJSON(logged)};milestone=Number((vprogress/300*100).toFixed(1)),[10,25,50,75,90].includes(milestone)&&(en="video_progress",vct=vprogress,vs=`Progress ${milestone}%`,sendData()),300===vprogress&&(document.querySelector("#video .text").classList.remove("playing"),en="video_complete",vct=vprogress,vs="Complete",vprogress=0,vplay=!1,vstop=!0,clearInterval(interval),sendData())}},1e3);if("Stop"===vs&&clearInterval(interval),"search-modal"===e.id){if(!logged)return message="ERROR: Please Sign In!",void errorEvent(e,message,logged,ui);en="search_modal_opened",searchModal()}if("search"===e.id){if(!e.previousElementSibling.value.trim())return message="ERROR: Search term can't be blank.",void errorEvent(e,message,logged,ui);{const verify=e.previousElementSibling.value.trim();if(verify.match(/mailto:|tel:|^[\w\-.]+@[\w\-.]+/gi))return message="ERROR: PII not allowed as search term.",errorEvent(e,message,logged,ui),void(e.previousElementSibling.value="");st=capitalize(verify),e.previousElementSibling.value=""}searchModal()}if("search-close"===e.id&&(en="search_modal_closed",searchModal()),"login"===e.id){if(logged)return message="ERROR: Oops! I'm sorry you already Sign In.",void errorEvent(e,message,logged,ui);logged=!0,ui=UUID}if("logout"===e.id){if(!logged)return message="ERROR: Oops! I'm sorry you need to Sign In first.",void errorEvent(e,message,logged,ui);logged=!1}const tstamp=(new Date).getTime(),cstamp=timeStamp();window.dataLayer=window.dataLayer||[],window.dataLayer.push({event:en||e.id,event_timestamp:tstamp,custom_timestamp:cstamp,button_text:"BUTTON"===e.tagName&&""!==e.innerText?e.innerText:void 0,contact_method:cm,currency:cc,event_type:"generate_lead"===en||"form_submit"===en?"conversion":"ui interaction",file_extension:"download"===e.id?"pdf":void 0,file_name:"download"===e.id?"PDF_to_Download":void 0,form_destination:fd,form_id:e.id.includes("form")?e.id:void 0,form_name:e.id.includes("form")?"User Profession Survey":void 0,form_submit_text:"form"===e.id?e.innerText:void 0,link_domain:ld,link_classes:lc,link_id:"extlink"===e.id||"intlink"===e.id||"download"===e.id?e.id:void 0,link_url:lu,link_text:"extlink"===e.id||"intlink"===e.id||"download"===e.id?e.innerText:void 0,method:"login"===e.id?"Google":void 0,outbound:ol,search_term:st,tag_name:e.tagName,value:val,video_current_time:vct,video_duration:vd,video_percent:vpct,video_provider:vp,video_status:"video"!==e.id||!0!==vplay&&!0!==vstop?void 0:vs,video_title:vt,logged_in:logged,user_id:ui,user_profession:up}),utag.link({tealium_event:en||e.id,event_timestamp:tstamp,custom_timestamp:cstamp,button_text:"BUTTON"===e.tagName&&""!==e.innerText?e.innerText:void 0,contact_method:cm,currency:cc,event_type:"generate_lead"===en||"form_submit"===en?"conversion":"ui interaction",file_extension:"download"===e.id?"pdf":void 0,file_name:"download"===e.id?"PDF_to_Download":void 0,form_destination:fd,form_id:e.id.includes("form")?e.id:void 0,form_name:e.id.includes("form")?"User Profession Survey":void 0,form_submit_text:"form"===e.id?e.innerText:void 0,link_domain:ld,link_classes:lc,link_id:"extlink"===e.id||"intlink"===e.id||"download"===e.id?e.id:void 0,link_url:lu,link_text:"extlink"===e.id||"intlink"===e.id||"download"===e.id?e.innerText:void 0,method:"login"===e.id?"Google":void 0,outbound:ol,search_term:st,tag_name:e.tagName,value:val,video_current_time:vct,video_duration:vd,video_percent:vpct,video_provider:vp,video_status:"video"!==e.id||!0!==vplay&&!0!==vstop?void 0:vs,video_title:vt,logged_in:logged,user_id:ui,user_profession:up}),displayJSON(logged)}document.querySelectorAll(".button").forEach(element=>{element.removeAttribute("disabled")}),e.setAttribute("disabled","")})});